@model IEnumerable<Music_Society_Forum.Models.Post>
    
@using Music_Society_Forum.Classes;

@{
    ViewBag.Title = "Admin Home";
}

@*Reviews*@
<section class="row">   
    <article class="col-md-12">
        @* Recommended Reviews *@
        <h2 class="view-header">Recommended Reviews (@ViewBag.RecommendedPosts.Count)</h2>
        @if (ViewBag.RecommendedPosts.Count == 0)
        {
            <div>No reviews.</div>
        }
        else
        {
            <table class="table">
                <tr>
                    <th>Title</th>
                    @*<th>Content</th>*@
                    <th>Date</th>
                    <th>Author</th>
                    <th>Comments</th>
                    <th>IsRecommended</th>
                    <th>Actions</th>
                </tr>
                @foreach (var post in ViewBag.RecommendedPosts)
                {
                    <tr>
                        <td>
                            @post.Title
                        </td>
                        @*<td>
                            @Html.Raw(Utils.CutText(post.Body, 100))
                        </td>*@
                        <td>
                            @post.Date
                        </td>
                        <td>
                            @if (post.Author != null)
                            {
                                if (post.Author.FullName != null)
                                {
                                    @post.Author.FullName
                                    @:(@post.Author.UserName)
                                    }
                                else
                                {
                                    @post.Author.UserName
                                }
                            }
                            else
                            {
                                <i>Undisclosed author</i>
                            }
                        </td>
                        <td>
                            @post.Comments.Count
                        </td>
                        <td>
                            @post.IsRecommended
                        </td>
                        <td>
                            @Html.ActionLink("Details", "../Posts/Edit", new { id = post.Id }) |
                            @Html.ActionLink("Edit", "Edit", new { id = post.Id }) |
                            @Html.ActionLink("Delete", "../Posts/Delete", new { id = post.Id })
                        </td>
                    </tr>
                }
            </table>
        }

        @* Anonimous Reviews *@
        <h2 class="view-header">Anonimous Reviews</h2>

        @if (ViewBag.AnonimousPosts.Count == 0)
        {
            <div>No reviews.</div>
        }
        else
        {
            <table class="table">
                <tr>
                    <th>Title</th>
                    @*<th>Content</th>*@
                    <th>Date</th>
                    <th>Author</th>
                    <th>Comments</th>
                    <th>IsRecommended</th>
                    <th>Actions</th>
                </tr>
                @foreach (var post in ViewBag.AnonimousPosts)
                {
                    <tr>
                        <td>
                            @post.Title
                        </td>
                        @*<td>
                            @Html.Raw(Utils.CutText(post.Body, 100))
                        </td>*@
                        <td>
                            @post.Date
                        </td>
                        <td>
                            @if (post.Author != null)
                            {
                                if (post.Author.FullName != null)
                                {
                                    @post.Author.FullName
                                    @:(@post.Author.UserName)
                            }
                                else
                                {
                                    @post.Author.UserName
                                }
                            }
                            else
                            {
                                <i>Undisclosed author</i>
                            }
                        </td>
                        <td>
                            @post.Comments.Count
                        </td>
                        <td>
                            @post.IsRecommended
                        </td>
                        <td>
                            @Html.ActionLink("Details", "../Posts/Edit", new { id = post.Id }) |
                            @Html.ActionLink("Edit", "Edit", new { id = post.Id }) |
                            @Html.ActionLink("Delete", "../Posts/Delete", new { id = post.Id })
                        </td>
                    </tr>
                }
            </table>
        }

        @* Recent Reviews *@
        <h2 class="view-header">Most Recent 5 Reviews</h2>
        <p>
            @Html.ActionLink("Read All Reviews", "Posts") (@ViewBag.PostsCount)
        </p>

        @if (Model.Count() == 0)
        {
            <div>No reviews.</div>
        }
        else
        {
            <table class="table">
                <tr>
                    <th>@Html.DisplayNameFor(model => model.Title)</th>
                    @*<th>Content</th>*@
                    <th>@Html.DisplayNameFor(model => model.Date)</th>
                    <th>@Html.DisplayNameFor(model => model.Author)</th>
                    <th>@Html.DisplayNameFor(model => model.Comments)</th>
                    <th>@Html.DisplayNameFor(model => model.IsRecommended)</th>
                    <th>Actions</th>
                </tr>
                @foreach (var post in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => post.Title)
                        </td>
                        @*<td>
                            @Html.Raw(Utils.CutText(post.Body, 100))
                        </td>*@
                        <td>
                            @Html.DisplayFor(modelItem => post.Date)
                        </td>
                        <td>
                            @if (post.Author != null)
                            {
                                if (post.Author.FullName != null)
                                {
                                    @Html.DisplayFor(modelItem => post.Author.FullName)
                                    @:(@Html.DisplayFor(modelItem => post.Author.UserName))
                                }
                                else
                                {
                                    @Html.DisplayFor(modelItem => post.Author.UserName)
                                }
                            }
                            else
                            {
                                <i>Undisclosed author</i>
                            }
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => post.Comments.Count)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => post.IsRecommended)
                        </td>
                        <td>
                            @Html.ActionLink("Details", "../Posts/Edit", new { id = post.Id }) |
                            @Html.ActionLink("Edit", "Edit", new { id = post.Id }) |
                            @Html.ActionLink("Delete", "../Posts/Delete", new { id = post.Id })
                        </td>
                    </tr>
                }
            </table>
        }

        @* Recent Comments *@
        <h2 class="view-header">Most Recent 5 Comments</h2>
        <p>
            @Html.ActionLink("Read All Comments", "Comments") (@ViewBag.CommentsCount)
        </p>

        @if (ViewBag.NewComments.Count == 0)
        {
            <div>No comments.</div>
        }
        else
        {
            <table class="table">
                <tr>
                    <th>On</th>
                    <th>Date</th>
                    <th>Author</th>
                    <th>Actions</th>
                </tr>
                @foreach (var comment in ViewBag.NewComments)
                {
                    <tr>
                        <td>
                            @comment.Post.Title
                        </td>                        
                        <td>
                            @comment.Date
                        </td>
                        <td>
                            @if (comment.Author != null)
                            {
                                if (comment.Author.FullName != null)
                                {
                                    @comment.Author.FullName
                                    @:(@comment.Author.UserName)
                                }
                                else
                                {
                                    @comment.Author.UserName
                                }
                            }
                            else
                            {
                                <i>Undisclosed author</i>
                            }
                        </td>                        
                        <td>
                            @Html.ActionLink("Details", "../Comments/Index", new { id = comment.Id }) |
                            @Html.ActionLink("Edit", "../Comments/Edit", new { id = comment.Id }) |
                            @Html.ActionLink("Delete", "../Comments/Delete", new { id = comment.Id })
                        </td>
                    </tr>
                }
            </table>
        }
    </article> 
</section>